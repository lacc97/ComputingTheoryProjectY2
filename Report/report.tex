\documentclass[11pt]{article}

%packages
\usepackage[british]{babel}
\usepackage{mathtools}              % AMS Math Package
\usepackage{amsthm}                 % Theorem Formatting
\usepackage{physics}
\usepackage{graphicx}               % Allows for eps images
% \usepackage{multicol}             % Allows for multiple columns
% \usepackage{sectsty}                % custom sectionals
\usepackage{titlesec}
\usepackage[small]{caption}         % small captions
\usepackage{newtxtext,newtxmath}    % font change
% \usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{csquotes}
\usepackage{enumerate}              % custom enumerations
\usepackage{url}                    % nice url fonts
\usepackage[a4paper,top=2.54cm,bottom=2.54cm,left=3.18cm,right=3.18cm]{geometry}
\usepackage[separate-uncertainty=true]{siunitx}
\usepackage{float}
\usepackage[style=ieee,backend=biber]{biblatex}
\usepackage{tikz}
\usepackage{parskip}
\usepackage{booktabs}
\usepackage{multirow}
%end packages

\usepackage{subcaption}

%commands
\renewcommand{\labelenumi}{(\alph{enumi})}
\newtheorem{prop}{Proposition}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\theoremstyle{definition}
\newtheorem{dfn}{Definition}
\theoremstyle{remark}
\newtheorem*{rmk}{Remark}

\bibliography{report}

\titlelabel{\thetitle.\quad}

\titleformat*{\section}{\normalfont\bfseries}
\titlespacing*{\section}{0pt}{1.1\parskip}{.33\parskip}
\titleformat*{\subsection}{\normalfont\bfseries}
\titlespacing*{\subsection}{0pt}{1.1\parskip}{.33\parskip}
\titleformat*{\subsubsection}{\normalfont\bfseries}
\titlespacing*{\subsubsection}{0pt}{1.1\parskip}{.33\parskip}

\let\oldvec=\vec
\renewcommand{\vec}[1]{\vb{#1}}
\newcommand{\uvec}[1]{\vu{#1}}

\DeclareSIUnit\solarmass{M_{\odot}}

%cover page command
\newcommand{\makecover}[5]{
\thispagestyle{empty}
\setcounter{page}{0}
\begin{center}\LARGE{\bf #1}\vskip 24pt \normalsize{#2}\hspace*{\fill}\\
#3\vskip 12pt School of Physics and Astronomy\\The University of Manchester\vskip 12pt Theory Computing Project Report\vskip 12pt #4\end{center}\vskip 54pt

\section*{Abstract}
#5
\newpage}
%end of coverpage command

\pagestyle{plain}%page numbers in footer

\begin{document}
    \makecover
    {Neutron stars}
    {Tomoi Goto and Luis Caceres Cueva}
    {10139083 and 9916879}
    {May 2019}
    {In this project, the effects of the internal structure of the neutron stars on their maximum radius and mass were examined by solving the Tolman-Oppenheimer-Volkoff equation with appropriate equation of states using 4th order Runge-Kutta method. For the equation of state, pure Fermi gas consisting of proton and neutron was used, and different strength of nuclear interactions were considered by varying the nuclear incompressibility. [Results comes here].}
    
    \section{Introduction}
        Neutron stars, created by supernovae of <5 solar mass stars, have a mean density of around $10^{15} gcm^{-3}$ and are in a low temperature regime of the nuclear matter \cite{shapiro.teukolsky.1983/bh.wd.ns.co}. Compared to high temperature but low density enviroment in the particle accelerators such as LHC in CERN, this highly dense but low temperature state of the matter inside the neutron star cannot be recreated in the laboratory on the Earth \cite{graber.andersson.2017/ns.lab}. So the neutron star offers an opportunity for studying the equation of states at extremely high density, which have not been constrained well yet and uncertaintly remains.  
        To further illustrate, there are multiple models for the equation of state of the matter, each consisiting of diffetent matters (eg. strange quark, hyperion etc) and varying strength of the internuclear interaction, which result in different mass-radius relation of the neutron star when calculated numerically \cite{graber.andersson.2017/ns.lab}. So, by comparing the calculated mass-radius relation with the actual observation of the radii and masses of the neutron stars, one could restrict the models and its parameter to have a better idea of high density state of matters.
        In this report, we pursue the pure Fermi gas model with nuclear interaction with symmetric ennergy as the equation of state, and calculate its mass-radius relation at different strength of the nuclear interaction. Then we compare our result with other proposed equation of states and the actual observed mass and radii acquired from low mass X-ray binaries and the neutron star mergre event of GW170817.
    
    \section{Theory}
        \subsection{Structure equation}
            For a fluid in hydrostatic equilibrium, we have \[\rho\vec{f}=\grad{p},\] where $\rho$ is the density, $\vec{f}$ is the force per unit mass and $p$ is the pressure. Hence, when the force is Newtonian gravity, \[\dv{p}{r}=-\frac{G\rho M}{r^{2}},\] where $r$ is the distance from the center of the neutron star, $p=p(r)$ is the pressure at radius $r$, $\rho=\rho(r)$ is the density at radius $r$, $M=M(r)$ is the mass of the inner shell of radius $r$ and $G$ is the gravitational constant. In a general relativistic treatment, some correction factors must be incorporated \parencite{silbar.reddy.2004/neutron.stars}, and hence we write Equation \ref{eq/tov.pressure},
            \begin{align}
                \label{eq/tov.pressure}\dv{p}{r}&=-\frac{G\rho M}{r^{2}}\qty[1+\frac{p}{\epsilon}]\qty[1+\frac{4\pi r^{3}p}{Mc^{2}}]\qty[1-\frac{2GM}{c^{2}r}]^{-1}\\
                \label{eq/tov.mass}\dv{M}{r}&=4\pi r^{2}\rho,
            \end{align}
            where $\epsilon=\epsilon(r)$ is the energy density at radius $r$ and $c$ is the speed of light. Equation \ref{eq/tov.mass} is straightforward from the definition of the mass of an inner spherical shell.

            
        \subsection{Fermi gas model} % TODO cite pdf and koonin
            The neutron matter inside of a neutron star can be modeled as a degenerate Fermi gas at temperature $T=\SI{0}{\kelvin}$.\footnote{This is a valid approximation because the Fermi temperature at the densities we are considering (up to \SI{e21}{\kilogram\per\meter\cubed}) is in the order of \SI{e12}{\kelvin}, which is much higher than core temperatures of very massive stars at the end of their lives ($\sim\SI{e9}{\kelvin}$).} In this model, the energy density can be written as \parencite{koonin.1986/computational.physics/rk4.white.dwarf}
            \[\epsilon=2\int_{0}^{k_{F}}E(k)g(k)\dd{k},\] where $g(k)=k^{2}/2\pi^{2}$ is the density of states function, $E(k)=\sqrt{\hbar^{2}c^{2}k^{2}+m^{2}c^{4}}$ is the relativistic energy of the state with wavenumber $k$, and $m$ is the mass of the fermion (in this case, a neutron). With the substitution $y=\hbar k/mc$ and defining a function \parencite{koonin.1986/computational.physics/rk4.white.dwarf} \[I(x)\equiv \frac{3}{8x^{3}}\qty[x(1+2x^{2})(1+x^{2})^{1/2}-\log(x+\sqrt{1+x^{2}})]\] in terms of dimensionless $x=\hbar k_{F}/mc$ to simplify the notation, the energy density can be written as \[\epsilon=\epsilon_{0}x^{3}I(x),\] where $\epsilon_{0}=m^{4}c^{5}/\pi^{2}\hbar^{3}$ is a constant.
            
            Calculating the number density is simpler, \[n=2\int_{0}^{k_{F}}g(k)\dd{k}=\frac{k_{F}^{3}}{3\pi^{2}}=n_{0}x^{3},\] where $n_{0}=m^{3}c^{3}/3\pi^{2}\hbar^{3}$ is a constant. Hence, calculating the mass density is straightforward, \[\rho=mn_{0}x^{3}=\rho_{0}x^{3},\] where $\rho_{0}=mn_{0}$ is another constant.
            
            In summary, we have the following quantities in terms of dimensionless $x$ (which in turn is a function of the Fermi wavenumber $k_{F}$):
                \begin{align}
                    x&=\frac{\hbar k_{F}}{mc}\\
                    n&=n_{0}x^{3},\\
                    \label{eq/fermi/mass.density}\rho&=\rho_{0}x^{3},\\
                    \label{eq/fermi/energy.density}\epsilon&=\epsilon_{0}x^{3}I(x).
                \end{align}
                
            Hence, we can calculate the pressure \begin{equation}\label{eq/fermi/pressure}p=\qty(\pdv{U}{V})_{N}=n^{2}\qty[\pdv{n}(\frac{\epsilon}{n})]_{N}=\frac{1}{3}\epsilon_{0}x^{4}I'(x).\end{equation}

        
        \subsection{Fermi gas with nucleon interactions}
            Extending the Fermi gas model, we can write that the energy per nucleon for symmetric matter (i.e. number of protons equal to the number of neutrons) is given by \parencite{silbar.reddy.2004/neutron.stars} \[\frac{\epsilon(n)}{n}=mc^{2}I(x)+V(u)\] where $x=\sqrt[3]{n/n_{0}}$ is as in the previous section, $V(u)$ is the nucleon interaction potential written in terms of the dimensionless quantity $u=n/n_{1}$, where $m$ is the mass of a nucleon (i.e. we ignore the small difference between the proton and neutron mass) and $n_{1}$ is the saturation density (i.e. the density at which the potential $V$ is the minimum and is equal to the binding energy per nucleon of elemental matter). We also make the assumption that this potential applies to all neutron stars. % TODO explain this
            
            For small $x$, we can approximate $I(x)$ as \[I(x)\approx1+\frac{3}{10}x^{2}.\] Writing $x^{3}=\eta u$, where $\eta=n_{1}/n_{0}$ is the ratio between constants, we have \begin{equation}\label{eq/symmetric.energy}\frac{\epsilon(n)}{n}=mc^{2}\qty(1+\frac{3\eta^{2/3}}{10}u^{2/3})+V(u).\end{equation} % TODO explainl why we can use non relativistic approximation
            
            We can parametrise the equations for antisymmetric matter using a parameter $\alpha$ such that $n_{p}=(1-\alpha)n/2$ and $n_{n}=(1+\alpha)n/2$ where $n_{p}$ and $n_{n}$ are the proton density and neutron density, respectively \parencite{silbar.reddy.2004/neutron.stars}. Hence, we can write an approximation for the energy per nucleon of antisymmetric matter \parencite{prakash.ainsworth.lattimer.1988/eos}, \begin{equation}\label{eq/antisymmetric.energy}E(n,\alpha)=E(n,0)+\alpha^{2}S(n)\end{equation} where $E(n,0)$ is the energy per nucleon of symmetric matter given by Equation \ref{eq/symmetric.energy} and $S(n)$ is the symmetry breaking energy. Following Prakash et al. \cite{prakash.ainsworth.lattimer.1988/eos}, we use \begin{equation}\label{eq/symmetry.breaking}S(n)=E_{N}(2^{2/3}-1)\qty(u^{2/3}-F(u))+S_{0}F(u)\end{equation} where $u=n/n_{1}$ as before, $S_{0}=\SI{30}{\mega\electronvolt}$ \parencite{silbar.reddy.2004/neutron.stars} is the bulk symmetry energy parameter, $F(u)$ is an arbitrary function such that $F(0)=0$ and $F(1)=1$ and \[E_{N}=\frac{3}{10}mc^{2}\eta^{2/3}\] is the kinetic energy per nucleon at equilibrium density $n=n_{1}$. Thus we can write the energy per nucleon for pure neutron matter ($\alpha=1$) as \[E(n,1)=\frac{\epsilon}{n}=mc^{2}+E_{N}u^{2/3}+V(u)+E_{N}(2^{2/3}-1)\qty(u^{2/3}-F(u))+S_{0}F(u).\] Now we can find an expression for the pressure, \[p=n^{2}\pdv{n}\qty(\frac{\epsilon}{n})=E_{N}n_{1}u^{2}\qty[\frac{2}{3}u^{-1/3}+\frac{V'(u)}{E_{N}}+(2^{2/3}-1)\qty(\frac{2}{3}u^{-1/3}-F'(u))+\frac{S_{0}}{E_{N}}F'(u)].\] To simplify calculations we define \[J(u)\equiv u^{2}\qty[\frac{2}{3}u^{-1/3}+\frac{V'(u)}{E_{N}}+(2^{2/3}-1)\qty(\frac{2}{3}u^{-1/3}-F'(u))+\frac{S_{0}}{E_{N}}F'(u)]\] such that we can write \[p=E_{N}n_{1}J(u).\]
            
            \subsubsection{The symmetric nucleon potential}
                So far, we have an expression for the equation of state as the pressure in terms of a function $J(u)$ of density $u=n/n1$, but this function in turn is written in terms of the nucleon interaction potential $V(u)$, for which we do not yet have an expression.
                
                In this work, we use the potential proposed by Bludman and Dover \cite{bludman.dover.1980/extrapolation.skyrme.eos}. This form of the nucleon interaction potential is based on the empirical Skyrme interaction and is modified to account for higher densities than atomic nuclear densities while ensuring that the sound speed in such matter is below the speed of light \cite{bludman.dover.1980/extrapolation.skyrme.eos}. This potential can be written as \parencite{silbar.reddy.2004/neutron.stars} \[V(u)=\frac{A}{2}u+\frac{Bu^{\sigma}}{(1+\sigma)(1+C_{1}u^{\sigma-1})},\] where $A$, $B$, $C_{1}$ and $\sigma$ are constants chosen to fit the parameters of nuclear matter at saturation nuclear densities \parencite{bludman.dover.1980/extrapolation.skyrme.eos}.
                
                Hence, using Equation \ref{eq/symmetric.energy} to express the energy per nucleon, we must have:
                \begin{enumerate}
                    \item the energy per nucleon has a minimum at the saturation density $n=n_{1}$, \[\qty(\dv{u}\qty[\frac{\epsilon(n)}{n}])_{u=1}=0;\]
                    \item the value of the energy per nucleon at the minimum must be equal to the binding energy per nucleon $E_{B}=-\SI{16}{\mega\electronvolt}$ \parencite{silbar.reddy.2004/neutron.stars}, \[\frac{\epsilon(n_{1})}{n_{1}}-mc^{2}=E_{B};\]
                    \item the value of the compressibility at the saturation density must be $K_{0}$ which has a value between \SI{200}{\mega\electronvolt} and \SI{400}{\mega\electronvolt} \parencite{silbar.reddy.2004/neutron.stars},\footnote{In this work, we will fit the parameters of the nucleon interaction potential for different values of $K_{0}$.} \[K(n_{1})=9\dv{p}{n}=K_{0};\]
                    \item the value of $C_{1}$ is chosen such that the speed of sound in the matter is lower than the speed of light \parencite{bludman.dover.1980/extrapolation.skyrme.eos}, \[\qty(\frac{c_{s}}{c})^{2}=\pdv{p}{\epsilon}<1.\]
                \end{enumerate}

                The potential, although empirical, can be interpreted physically. Given that $A$ is negative, the linear represents the attractive strong force interaction of nearest neighbour nucleons. The other term instead represents the multiple body repulsive interactions with neighbours \parencite{bludman.dover.1980/extrapolation.skyrme.eos} (such as Coulombic or degeneracy pressure interactions).
            
        \subsection{Observational method}
            There are number of methods for measuring the mass of a neutron star, but the measurements of low-mass X-ray binaries are useful, since not only the mass but also the radius can be determined simultaneously \parencite{ozel.paulo.2016/masses.radii.eos}. There are two methods for determining the radius of the neutron star in the LMXB, one is to measure the thermal emmision from a quiescent LMXB, and the other is to measure the flux produced by the thermonuclear bursts \parencite{ozel.paulo.2016/masses.radii.eos}.
            
            Low mass X-ray binaries have a donor star ($M<\SI{1.5}{\solarmass}$) that transfers materials to the neutron star, which results in an acretion disk around the neutron star \parencite{tauris.2003/xray.binary}. When the LMXB is in a quiescent period, the neutron emits thermal radiation due to the heating up from the accretion, and its spectrum can be analyzed to obtain the angular size of the neutron star, from which the radius can be determined \parencite{ozel.psaltis.2016/radius.oberve}.
            
            LMXB can also undergo thermonuclear bursts, which are caused by the ignition of helium on the surface of the neutron star due to the accretion \parencite{ozel.paulo.2016/masses.radii.eos}. This results in the expansion of neutron star's photosphere due to the radiation pressure, which is then counter-balanced by gravity until equilibrium, and hence the Eddington luminosity, is reached. As the burst cools down the photosphere shrinks and the Eddington luminosity decreases, and by measuring the flux when the photosphere touches the neutron star, the radius of the neutron star can be calculated using the expression for the Eddington luminosity \parencite{ozel.psaltis.2016/radius.oberve}.
            
            Other than the observations in the electromagnetic spectrum of LMXB, the advent of the gravitational wave detectors made it possible to measure the total mass of a system of 2 neutron stars and their radii by observing merging events. In particular, the  radii and masses of the neutron stars in the event GW170817 has been calculated by the LIGO Scientific Collaboration and Virgo Collaboration \cite{ligo.virgo.2019/prop.of.ns.merger.GW170817,ligo.virgo.2018/GW170817.ns.radii}. In this report we use the radius inferred from the effect of the tidal deformation of the neutron stars on the signal of the gravitational wave, as presented in the paper by LIGO \cite{ligo.virgo.2018/GW170817.ns.radii}. Since the upgrade in the sensitivity of the LIGO detector in the spring of 2019, it is expected to detect gravitatonal wave event more frequently, so we can expect that there will be more data available on the radii of neutron stars \cite{ligo.update.2019}. % TODO Move this sentence to conclusion maybe? - I agree
    
    \section{Methodology}
        \subsection{Runge-Kutta integration}
            The main source of error in the Runge-Kutta method is the truncation error, which can be estimated by performing integration on two different step sizes $h_1=2h$ and $h_2=h$, and using the results $Y_1$ and $Y_2$ in the formula  \parencite{lotkin.1951/rk.accuracy} \[E_2=(Y_1-Y_2)/15\] where $E_2$ is the estimated error when the step size is $h_2$. In our case we performed first integration at a given step size, and then performed another integration with twice the step size to then calculate the error on mass $M_{\text{err}}$ when pressure $p$ reaches 0. After trying several step size with different EOS and intial pressure, we found that for the step size of $h=\SI{1}{\meter}$ the error on the mass $M_{\text{err}}$ stays in the range between \SI{e-10}{\solarmass} to \SI{e-5}{\solarmass}, much smaller than the calculated masses of the neutron stars which are around \SI{1}{\solarmass}, so this step size was chosen for calculating all the EOS.
        
        \subsection{Polytropic method}
            One way to integrate the equation of states is to express them in polytropes of the form $\epsilon(p) = a_1 p^{\gamma_1} + a_2 p^{\gamma_2}$, where $\epsilon$ is the energy density, $p$ is the pressure, and the rest of $a_1$, $a_2$, $\gamma_1$, and $\gamma_2$ are the parameter that need to be fit. The merit of this method is that the only thing the integrating program needs to know are the four parameters which can be determined for each equation of states. We used the polytropic method for integrating the equation of states of Fermi gas without nuclear interaction.


            In order to deterrmine the four parameters in the case of pure Fermi gas model, firstly the energy density $\epsilon(k)$ and the pressure $p(k)$ as functions of momentum $k$ were calculated numerically for a given range. Then the calculated $\epsilon$ and $p$ were plotted against each other, and then we chose the $\gamma_1$ and $\gamma_2$ according to both the literature and trial and error to fit the $\epsilon$ as the function of $p$ to get the rest of the parameters $a_1$ and $a_2$. Finally, using the obtained parameters we integrated the structure equation with the polytropic equation of state to obtain the mass and radius of a neutron star with a given initial pressure.

        \subsection{Tabulated equation of states}
            The downside of the polytropic method is that when the shape of the $\epsilon$-$p$ curve becomes more complex, the polytropic fit would differ too much from the original equation of state. So, alternatively it is also possible to use a tabulated equation of states when integrating the structure equation. A table of $\epsilon$ and $p$ can be generated and then can be linearly interpolated to be used structure equation directly. There are tabulted equation of states available online for various models and parameters, and we integrated several of them to compare with our model in the result and discussion section \cite{arizona/eos.table}.

        \subsection{Integrating density instead of pressure}
            To perform the integration of the TOV equation (Equations \ref{eq/tov.pressure} and \ref{eq/tov.mass}), we would have to find an explicit expression for $\rho$ and $\epsilon$ in terms of pressure $p$. However, by inspecting Equation \ref{eq/fermi/pressure}, it is very difficult to do so even for the simpler Fermi gas model.
            
            Nonetheless, by inverting Equation \ref{eq/fermi/mass.density} to find an expression for $x$ in terms of the mass density $\rho$ we can therefore write all other relevant quantities as functions of the mass density. As such, it would be necessary to rewrite the TOV equation in terms of $\rho$. This is straightforward with the chain rule and thus we can write \begin{equation}\label{eq/tov.density}\dv{\rho}{r}=-\qty(\dv{p}{x})^{-1}\qty(\dv{\rho}{x})\frac{G\rho M}{r^{2}}\qty[1+\frac{p}{\epsilon}]\qty[1+\frac{4\pi r^{3}p}{Mc^{2}}]\qty[1-\frac{2GM}{c^{2}r}]^{-1}\end{equation} where the derivatives in terms of $x$ are calculated according the specific model used (Fermi gas or with nucleon interactions).
    
    \section{Results and discussion}
        \subsection{Comparison between Fermi gas model and nucleon interaction model}
            As shown in Figure \ref{fig/comparison.our.models}, there is a clear difference between the Fermi gas models with Newtonian structure and the GR structure. Given that the GR correction terms shown in Equation \ref{eq/tov.pressure} are all positive and greater than one, they effectively ``amplify'' the effect of gravity \parencite{silbar.reddy.2004/neutron.stars} and hence for a given initial mass density, the resulting neutron star will be smaller and less massive, as shown in the figure.
            
            \begin{figure}[h]\begin{center}
                \begin{subfigure}[b]{.49\textwidth}
                    \includegraphics[width=\textwidth]{eos_compare_our_model}
                    \caption{Comparison between Fermi gas model and model with nucleon interactions}\label{fig/comparison.our.models}
                \end{subfigure}
                \begin{subfigure}[b]{.49\textwidth}
                    \includegraphics[width=\textwidth]{eos_compare_paper}
                    \caption{Comparison between our models and other models}\label{fig/comparison.paper}
                \end{subfigure}
                \caption{Comparison between different equation of state models}
            \end{center}\end{figure}
            
            Additionally, the simpler Fermi gas model produces less compact neutron stars compared to the model that accounts for nucleon interactions. This is as expected because the Fermi gas model only considers a repulsive interaction due to degeneracy pressure, while the other model includes the attractive strong interaction between neutrons.
        
        \subsection{Comparison with other EOS models from the literature}
            
        
        \subsection{Comparison with actual neutron star measurement data}
<<<<<<< Updated upstream
            \begin{figure}[h]\begin{center}
                \begin{subfigure}[b]{.49\textwidth}
                    \includegraphics[width=\textwidth]{eos_compare_obsv1_GW}
                    \caption{}
                \end{subfigure}
                \begin{subfigure}[b]{.49\textwidth}
                    \includegraphics[width=\textwidth]{eos_compare_obsv2_GW}
                    \caption{}
                \end{subfigure}
                \caption{Comparison between our models and measured neutron star masses and radii}
            \end{center}\end{figure}
=======
            We use one is from low mass X-ray binaries and other is from the gravitational event caused by the nuetron star mergre is used.
>>>>>>> Stashed changes
        
        [Say the effect of nuclear interaction on the mass and radius]. [Compare the result with other models using diagram]. [Pick few models and explain a bit deeper, why they have their distinct shapes].
    
    \section{Conclusion}
    
    \printbibliography
\end{document}
